(function(){var e,t,n,a,r,i,s,l={attr:[],class:[],for:[],html:[],if:[],on:[],rdo:[]},f={attr:"attributeName",class:"className",for:"itemName",on:"eventName"},c=1,m=!1;e=function(t){return t=t.replace(/\[([^\[\]]*)\]/g,function(e,t){return"."+n(t)}),/\[[^\[\]]*\]/.test(t)?e(t):t},t=function(e,t){var n=Object.assign(e,window.directives.baseReference);return n[t]},n=function(a,r,i){var s,l,f=-1!==a.indexOf("["),c=-1!==a.indexOf("."),m=!1;if(0===a.indexOf("!")&&(a=a.substring(1),m=!0),r||(r={}),/[=<!>]/.test(a)){var o=a.match(/([=<!>]+)/)[0];if(-1!==["==","===","!=","!==","<",">","<=",">="].indexOf(o)){var u,d=a.split(o),v=n(d[0]),p=n(d[1]);switch("function"==typeof v&&(v=v.apply(r)),"function"==typeof p&&(p=p.apply(r)),o){case"==":u=v==p;break;case"===":u=v===p;break;case"!=":case"!==":u=v!=p;break;case"<":u=v<p;break;case">":u=v>p;break;case"<=":u=v<=p;break;case">=":u=v>=p}return u}return""}if(/[^a-z0-9.[\]:;,$_]/i.test(a))return"";if(f||c){if(f&&(a=e(a),c||(c=!0)),c){var h=a.split(".");h.forEach(function(e,n){n?"object"==typeof l&&l[e]?i&&n===h.length-1?s=e:l=l[e]:l="":l=t(r,e)})}}else l=t(r,a);return i&&s?(l.$lastPart=s,l.$returnOpposite=m,l):m?!l:l},a=function(e,t,o){var u=!1,d=!1;c||(c=1),s(e),["if","for","html","attr","rdo","class","on"].some(function(a){var i,s=e.getAttribute("sd-"+a).replace(/\s+/,"");if(!e.hasAttribute("sd-"+a))return!1;if("rdo"===a){var c=!1;if(l.rdo.some(function(t){if(t.element===e)return c=!0,!0}),c)return!1}i=-1!==["attr","class","on"].indexOf(a)&&-1!==s.indexOf(";")?s.split(";"):[s],i.forEach(function(i){var s={element:e},c=i.split(":");if(-1!==["if","html","rdo"].indexOf(a)?(s.reference=c.shift(),c.length&&(s.refArgs=c)):(s[f[a]]=c.shift(),s.reference=c.shift(),c.length&&(s.refArgs=c)),"for"===a&&(s.originalHTML=e.innerHTML),t){if(s.itemNames||(s.itemNames=[]),s.itemNames.push(t.itemName),Array.isArray(t.value))"object"==typeof t.value[o]?s[t.itemName]=t.value[o]:s[t.itemName]={value:t.value[o]},s[t.itemName].$key=o;else{var m=Object.keys(t.value)[o];"object"==typeof t.value[m]?s[t.itemName]=t.value[m]:s[t.itemName]={value:t.value[m]},s[t.itemName].$key=m}s[t.itemName].$collection=t.value,s[t.itemName].$index=o}if("on"===a){var v;if(v=-1!==s.reference.indexOf(",")?s.reference.split(","):[s.reference],-1!==v.indexOf("$update")){for(var p,h,b;-1!==(b=v.indexOf("$update"));)v.splice(b,1);s.element.hasAttribute("sd-attr")?"input"===s.element.tagName&&-1!==["checkbox","radio"].indexOf(s.element.getAttribute("type"))?(h=s.element.getAttribute("sd-attr"),p=h.indexOf("checked"),-1!==p&&(h=h.substring(p).split(":")[1],p=h.indexOf(";"),-1!==p&&(h=h.substring(0,p)),h=n(h,!1,!0),"function"!=typeof h[h.$lastPart]&&(s.updater=function(){h[h.$lastPart]=s.element.checked}))):(h=s.element.getAttribute("sd-attr"),p=h.indexOf("value"),-1!==p&&(h=h.substring(p).split(":")[1],p=h.indexOf(";"),-1!==p&&(h=h.substring(0,p)),h=n(h,!1,!0),"function"!=typeof h[h.$lastPart]&&(s.updater=function(){h[h.$lastPart]=s.element.value}))):s.element.hasAttribute("sd-html")&&s.element.isContentEditable?(h=n(s.element.getAttribute("sd-html"),!1,!0),"function"!=typeof h[h.$lastPart]&&(s.updater=function(){h[h.$lastPart]=s.element.innerHTML})):s.element.hasAttribute("sd-rdo")&&(h=n(s.element.getAttribute("sd-rdo"),!1,!0),"function"!=typeof h[h.$lastPart]&&(s.updater=function(){var e;Array.from(document.getElementsByName(s.element.name)).some(function(t){if(t.checked)return e=t.value,!0}),h[h.$lastPart]=e}))}v.length&&(s.listener=function(a){var r=!1,i={element:e,event:a};t&&(r[t.itemName]=s[t.itemName],i[t.itemName]=r[t.itemName]),v.forEach(function(e){if(-1!==e.indexOf("=")){var t=e.split("="),a=n(t[0],!1,!0);a[a.$lastPart]=n(t[1],r)}else n(e,r).apply(i,s.refArgs.map(function(e){return n(e,r)||e}))})}),r("add",s)}if(l[a].push(s),"if"===a){if(t){var N={};N[t.itemName]=s[t.itemName],s.value=n(s.reference,N)}else s.value=n(s.reference);if(!s.value)return e.style.display="none",u=!0,!0;e.style.display=null}else"for"===a&&(d=!0)})}),u||(d||(c+=e.children.length,Array.from(e.children).forEach(function(e){a(e)})),c-=1,c||m||i())},i=function(){var e;m||(m=!0),["if","for","html","attr","rdo","class"].forEach(function(t){if(l[t].forEach(function(e,r){if(e.element.parentElement){var i,f={element:e.element};switch(t){case"attr":f.attributeName=e.attributeName;break;case"class":f.className=e.className;break;case"for":f.itemName=e.itemName}if(e.itemNames){var c={};e.itemNames.forEach(function(t){c[t]=e[t],f[t]=c[t]}),i=n(e.reference,c)}else i=n(e.reference);if("function"==typeof i&&(i=i.apply(f,e.refArgs.map(function(e){return n(e)||e}))),-1!==["if","class"].indexOf(t)&&"boolean"!=typeof i&&(i=!!i),!e.value||e.value!==i)switch("for"===t&&(i=e.originalHTML.repeat(Array.isArray(e.value)?e.value.length:Object.keys(e.value).length)),e.value=i,t){case"if":i?(e.element.style.display=null,a(e.element)):(e.element.style.display="none",s(e.element,"if"));break;case"for":case"html":Array.from(e.element.children).forEach(function(e){s(e)}),e.element.innerHTML=i,Array.from(e.element.children).forEach(function(n,r){"for"===t?a(n,e,r):a(n)});break;case"attr":-1!==e.attributeName.indexOf(",")?e.attributeName.split(",").forEach(function(t){void 0===i?e.element.hasAttribute(t)&&e.element.removeAttribute(t):e.element.setAttribute(t,i)}):void 0===i?e.element.hasAttribute(e.attributeName)&&e.element.removeAttribute(e.attributeName):e.element.setAttribute(e.attributeName,i);break;case"rdo":Array.from(document.getElementsByName(e.element.name)).forEach(function(e){e.value===i?e.checked=!0:e.checked=!1});break;case"class":-1!==e.className.indexOf(",")?e.className.split(",").forEach(function(t){i?e.element.classList.contains(t)||e.element.classList.add(t):e.element.classList.contains(t)&&e.element.classList.remove(t)}):i?e.element.classList.contains(e.className)||e.element.classList.add(e.className):e.element.classList.contains(e.className)&&e.element.classList.remove(e.className)}}else l[t][r]=!1}),-1!==l[t].indexOf(!1))for(;-1!==(e=l[t].indexOf(!1));)l[t].splice(e,1)}),setTimeout(i,window.directives.refreshRate)},r=function(e,t){var n=e+"EventListener",a=t.element[n];if("input"===t.element.tagName&&"radio"===t.element.getAttribute("type")){var r=Array.from(document.getElementsByName(t.element.name));a=function(e,t){r.forEach(function(a){a[n](e,t)})}}-1!==t.eventName.indexOf(",")?t.eventName.split(",").forEach(function(e){t.listener&&a(e,t.listener),t.updater&&a(e,t.updater)}):(t.listener&&a(t.eventName,t.listener),t.updater&&a(t.eventName,t.updater))},s=function(e,t){var n;["attr","class","for","html","if","on"].forEach(function(t){if(l[t].length)if(e===document.body)"on"===t&&l.on.forEach(function(e){r("remove",e)}),l[t].length=0;else if(l[t].map(function(n){return e.contains(n.element)?("on"===t&&r("remove",n),!1):n}),-1!==l[t].indexOf(!1))for(;-1!==(n=l[t].indexOf(!1));)l[t].splice(n,1)})},window.directives={baseReference:window,refreshRate:100,register:a,unregister:s},"loading"!=document.readyState?setTimeout(function(){a(document.body)}):document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){a(document.body)})})})();