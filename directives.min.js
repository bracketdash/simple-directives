const simpleDirectives={};(function(e){function t(e){return{in:t=>-1!==t.indexOf(e),oneOf:t=>t.some(t=>t===e)}}function s(e){let t;for(;-1!==(t=e.indexOf(null));)e.splice(t,1)}class r{constructor(e,t){this.elements=[],this.pointers=[],this.root=t||window,this.register(e||document.body),this.runner()}register(e,r){const n=["sd-attr","sd-class","sd-for","sd-html","sd-if","sd-on","sd-rdo"];let c,a=!1;if(e.hasAttributes()&&!t(e).oneOf(this.elements.map(e=>e.scope.element))){let o=Array.from(e.attributes).map(s=>{let r=!0;return"sd-rdo"!==s.name||u.isFirstRdoOfGroup(this,e)||(r=!1),t(s.name).in(n)&&r?(t(s.name).in(["sd-if","sd-for"])&&(a=!0),{type:s.name,value:s.value.replace(/\s+/g,"")}):null});s(o),c=new i(this,e,o,r||{}),this.elements.push(c)}c&&a||Array.from(e.children).forEach(e=>this.register(e,r))}runner(){this.pointers.forEach(e=>e.run()),setTimeout(()=>this.runner(),200)}unregister(e){let t=this.elements;t=t.map(t=>t.scope.element===e||e.contains(t.scope.element)?t.unregister():t),s(t)}getSimpleElement(e){let t;return this.elements.some(s=>{if(s.scope.element===e)return t=s,!0}),t}}class i{constructor(e,s,r,i){this.directives=[],this.instance=e,this.scope=i,this.scope.element=s,r.forEach(e=>{if(t(e.name).in(["sd-attr","sd-class","sd-on"])&&t(";").in(e.value)){const t=e.value.split(";");t.forEach(t=>this.directives.push(n.getDirective(this,e.name,t)))}else this.directives.push(n.getDirective(this,e.name,e.value))})}unregister(){return this.directives.forEach(e=>{e instanceof p&&e.destroy(),e instanceof o&&(this.scope.element.innerHTML=e.originalHTML)}),this.instance.pointers=this.instance.pointers.map(e=>{const t=E.bubbleUp(e);return t.element===this?null:e}),s(this.instance.pointers),null}}class n{constructor(e,t){this.element=e,this.expression=t,this.scope=e.scope}static getDirective(e,t,s){switch(t.substring(3)){case"attr":return new c(e,s);case"class":return new a(e,s);case"for":return new o(e,s);case"html":return new h(e,s);case"if":return new l(e,s);case"on":return new p(e,s);case"rdo":return new u(e,s)}}static getExpressionParts(e){const t=e.split(":"),s=t.shift(),r=t.join(":");return[s,r]}}class c extends n{constructor(e,t){super(e,t);const[s,r]=n.getExpressionParts(t);this.attribute=s,this.scope.attributeName=this.attribute,this.reference=E.getReference(this,r)}run(e){const s=this.scope.element;"value"===this.attribute&&"SELECT"===s.tagName?Array.from(s.getElementsByTagName("option")).forEach(s=>{Array.isArray(e)&&t(s.value).in(e)||e==s.value?s.selected=!0:s.selected=!1}):e?s.setAttribute(this.attribute,e):s.hasAttribute(this.attribute)&&s.removeAttribute(this.attribute)}}class a extends n{constructor(e,t){super(e,t);const[s,r]=n.getExpressionParts(t);this.classes=s.split(","),this.scope.classNames=this.classes,this.reference=E.getReference(this,r)}run(e){const t=this.scope.element;this.classes.forEach(s=>{e?t.classList.contains(s)||t.classList.add(s):t.classList.contains(s)&&t.classList.remove(s)})}}class o extends n{constructor(e,t){super(e,t);const[s,r]=n.getExpressionParts(t);this.alias=s,this.scope.itemName=this.alias,this.reference=E.getReference(this,r),this.originalChildren=this.scope.element.children.length,this.originalHTML=this.scope.element.innerHTML}run(e){const t=e,s=this.element,r=this.scope.element,i=document.createElement("div");e&&(i.innerHTML=this.originalHTML.repeat(t.length),Array.from(r.children).forEach(e=>{s.instance.unregister(e),r.removeChild(e)}),Array.from(i.children).forEach((e,i)=>{const n=Math.floor(i/this.originalChildren),c=Object.assign({},this.scope);c[this.alias]=Object.assign({$collection:t,$index:n},t[n]),r.appendChild(e),s.instance.register(e,c)}),"SELECT"===r.tagName&&s.directives.some(e=>{if(e instanceof c&&"value"===e.attribute)return setTimeout(()=>e.run(e.reference.get())),!0}))}}class h extends n{constructor(e,t){super(e,t),this.reference=E.getReference(this,t)}run(e){const t=this.element.instance,s=this.scope.element;Array.from(s.children).forEach(e=>t.unregister(e)),s.innerHTML=e,Array.from(s.children).forEach(e=>t.register(e,this.scope))}}class l extends n{constructor(e,t){super(e,t),this.reference=E.getReference(this,t)}run(e){const t=this.element.instance,s=this.scope.element;e?(s.style.display=null,Array.from(s.children).forEach(e=>t.register(e,this.scope))):(s.style.display="none",Array.from(s.children).forEach(e=>t.unregister(e)))}}class u extends n{constructor(e,t){super(e,t),this.reference=E.getReference(this,t)}run(e){const t=this.scope.element.getAttribute("name"),s=Array.from(document.getElementsByName(t));s.forEach(t=>{t.value===e?t.checked=!0:t.checked=!1})}static isFirstRdoOfGroup(e,t){let s=!0;return e.elements.some(({scope:e})=>{"INPUT"===e.element.tagName&&"radio"===e.element.getAttribute("type")&&e.element.getAttribute("name")===t.getAttribute("name")&&(s=!1)}),s}}class p extends n{constructor(e,s){super(e,s);const[r,i]=n.getExpressionParts(s);this.events=r.split(","),this.scope.eventNames=this.events,this.actions=i.split(",").map(e=>"$update"===e?this.getUpdater():t("=").in(e)?new d(this,e):new f(this,e)),this.listener=(e=>this.actions.forEach(t=>t.run(e))),this.events.forEach(e=>this.scope.element.addEventListener(e,this.listener))}destroy(){this.events.forEach(e=>this.scope.element.removeEventListener(e,this.listener))}getUpdater(){const e=this.scope.element;return e.hasAttribute("sd-attr")?"INPUT"===e.tagName&&t(e.getAttribute("type")).in(["checkbox","radio"])?new y(this):new b(this):e.hasAttribute("sd-html")&&e.isContentEditable?new v(this):e.hasAttribute("sd-rdo")?new A(this):void 0}}class m{constructor(e){this.directive=e}}class f extends m{constructor(e,t){super(e),this.callee=E.getReference(this,t)}run(e){const t=this.callee.obj[this.callee.key],s=this.callee.args.map(e=>e.bang?!e.obj[e.key]:e.obj[e.key]);t.apply(Object.assign({event:e},this.scope),s)}}class d extends m{constructor(e,t){super(e);const s=t.split("=");this.left=E.getReference(this,s[0]),this.right=E.getReference(this,s[1])}run(){const e=this.right.get();this.left.obj[this.left.key]=e}}class g extends m{}class b extends g{constructor(e){super(e),this.directive.element.directives.some(e=>{if(e instanceof c&&"value"===e.attribute&&e.reference instanceof x)return this.updatee=e.reference,!0})}run(){const e=this.scope.element.value;"number"!=typeof this.updatee.obj[this.updatee.key]||isNaN(Number(e))?this.updatee.obj[this.updatee.key]=e:this.updatee.obj[this.updatee.key]=Number(e)}}class y extends g{constructor(e){super(e),this.directive.element.directives.some(e=>{if(e instanceof c&&"checked"===e.attribute&&e.reference instanceof x)return this.updatee=e.reference,!0})}run(){const e=this.scope.element;this.updatee.obj[this.updatee.key]=e.checked}}class v extends g{constructor(e){super(e),this.directive.element.directives.some(e=>{if(e instanceof h&&e.reference instanceof x)return this.updatee=e.reference,!0})}run(){const e=this.scope.element;this.updatee.obj[this.updatee.key]=e.innerHTML}}class A extends g{constructor(e){super(e),this.directive.element.directives.some(e=>{if(e instanceof h&&e.reference instanceof x)return this.updatee=e.reference,!0})}run(){const e=this.scope.element.getAttribute("name"),t=Array.from(document.getElementsByName(e));let s;t.some(e=>{if(e.checked)return s=e.value,!0}),this.updatee.obj[this.updatee.key]=s}}class E{constructor(e){this.parent=e,this.scope=e.scope}static bubbleUp(e){let t=e;for(;t instanceof E;)t=t.parent;return t}static getReference(e,t,s){return/[=<!>]/.test(t.substring(1))?new j(e,t,s):new x(e,t,s)}}class j extends E{constructor(e,t,s){super(e);const r=t.match(/([=<!>]{1,3})/)[0],i=t.indexOf(r);this.comparator=r,this.left=E.getReference(this,t.substring(0,i),s),this.right=E.getReference(this,t.substring(i+r.length),s)}get(){const e=this.left.get(),t=this.right.get();switch(this.comparator){case"==":return e==t;case"===":return e===t;case"!=":case"!==":return e!=t;case"<":return e<t;case">":return e>t;case"<=":return e<=t;case">=":return e>=t}}}class x extends E{constructor(e,t,s){super(e),this.bang=!1;const r=t.split(":");this.base=r.shift(),this.args=r.map(e=>E.getReference(this,e,!0)),t.startsWith("!")&&(this.bang=!0,t=t.substring(1)),this.obj={value:t},this.key="value";let i=this.maybeGetObjAndKey(this.base,this.scope);if(i.nah&&(i=this.maybeGetObjAndKey(this.base)),i.nah||(this.obj=i.obj,this.key=i.key),!s){const e=E.bubbleUp(this);e instanceof n&&!(e instanceof p)&&(e.element.instance.pointers.push(this),this.run(!0))}}get(){let e=this.obj[this.key];if("function"==typeof e){const t=this.args.map(e=>e.bang?!e.obj[e.key]:e.obj[e.key]);e=e.apply(this.scope,t)}return this.bang?!e:e}maybeGetObjAndKey(e,s){const r={nah:!0},i=t("[").in(e);let c,a=t(".").in(e);if(s)c=s;else{let e=E.bubbleUp(this);e=e instanceof n?e.element.instance.root:e.directive.element.instance.root,c=e}if(/[^a-z0-9.[\]$_]/i.test(e))return r;if(!i&&!a)return c.hasOwnProperty(e)?{obj:c,key:e}:r;if(i){let t=!0;for(;/\[[^\[\]]*\]/.test(e);)e=e.replace(/\[([^\[\]]*)\]/g,(e,r)=>{const i=this.maybeGetObjAndKey(r,s);return i.key?"."+i.obj[i.key]:(t=!1,"")});if(!t)return r;a||(a=!0)}if(a){const t=e.split(".");let s;return t.some((e,r)=>{if(r===t.length-1)s=e;else{if("object"!=typeof c||!c.hasOwnProperty(e))return s=!1,!0;c=c[e]}}),"string"==typeof s?{obj:c,key:s}:r}}run(e){let t=this.get(),s=!1;Array.isArray(t)&&Array.isArray(this.value)?t.length!==this.value.length?s=!0:t.some((e,t)=>{if(e!==this.value[t])return s=!0,!0}):t!==this.value&&(s=!0),Array.isArray(t)&&(t=t.slice(0)),(s||e)&&(this.value=t,E.bubbleUp(this).run(t))}}e.register=((e,t)=>new r(e,t))})(simpleDirectives);