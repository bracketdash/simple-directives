(function(){var e,t,n,i,r,a,s={attr:[],class:[],for:[],html:[],if:[],on:[],rdo:[]},l={attr:"attributeName",class:"className",for:"itemName",on:"eventName"},m=1,f=!1;e=function(t){return t=t.replace(/\[([^\[\]]*)\]/g,function(e,t){return"."+n(t)}),/\[[^\[\]]*\]/.test(t)?e(t):t},t=function(e,t){var n=window.directives.baseReference;return e&&(n=Object.assign(e,n)),n[t]},n=function(n,i){var r,a=-1!==n.indexOf("["),s=-1!==n.indexOf("."),l=!1;return 0===n.indexOf("!")&&(n=n.substring(1),l=!0),/[^a-z0-9.[\]:;,$_]/i.test(n)?"":(a||s?(a&&(n=e(n),s||(s=!0)),s&&n.split(".").forEach(function(e,n){r=n?"object"==typeof r&&r[e]?r[e]:"":t(i,e)})):r=t(i,n),l?!r:r)},i=function(e,t,o){var c=!1,u=!1;m||(m=1),a(e),["if","for","html","attr","rdo","class","on"].some(function(i){var r;if(!e.hasAttribute("sd-"+i))return!1;if("rdo"===i){var a=!1;if(s.rdo.some(function(t){if(t.element===e)return a=!0,!0}),a)return!1}r=-1!==["attr","class","on"].indexOf(i)&&-1!==e.getAttribute("sd-attr").indexOf(";")?e.getAttribute("sd-"+i).split(";"):[e.getAttribute("sd-"+i)],r.forEach(function(r){var a={element:e},m=r.split(":");if(-1!==["if","html","rdo"].indexOf(i)?(a.reference=m.shift(),m.length&&(a.refArgs=m)):(a[l[i]]=m.shift(),a.reference=m.shift(),m.length&&(a.refArgs=m)),"for"===i&&(a.originalHTML=e.innerHTML),t){if(a.itemNames||(a.itemNames=[]),a.itemNames.push(t.itemName),Array.isArray(t.value))"object"==typeof t.value[o]?a[t.itemName]=t.value[o]:a[t.itemName]={value:t.value[o]},a[t.itemName].$key=o;else{var f=Object.keys(t.value)[o];"object"==typeof t.value[f]?a[t.itemName]=t.value[f]:a[t.itemName]={value:t.value[f]},a[t.itemName].$key=f}a[t.itemName].$collection=t.value,a[t.itemName].$index=o}if("on"===i){var d,v;if("$update"===a.reference){if(a.element.hasAttribute("sd-attr")?"input"===a.element.tagName&&-1!==["checkbox","radio"].indexOf(a.element.getAttribute("type"))?(v=a.element.getAttribute("sd-attr"),d=v.indexOf("checked"),-1!==d&&(v=v.substring(d).split(":")[1],d=v.indexOf(";"),-1!==d&&(v=v.substring(0,d)),v=n(v),"function"!=typeof v&&(a.listener=function(){v=a.element.checked}))):(v=a.element.getAttribute("sd-attr"),d=v.indexOf("value"),-1!==d&&(v=v.substring(d).split(":")[1],d=v.indexOf(";"),-1!==d&&(v=v.substring(0,d)),v=n(v),"function"!=typeof v&&(a.listener=function(){v=a.element.value}))):a.element.hasAttribute("sd-html")&&a.element.isContentEditable?(v=n(a.element.getAttribute("sd-html")),"function"!=typeof v&&(a.listener=function(){v=a.element.innerHTML})):a.element.hasAttribute("sd-rdo")&&(v=n(a.element.getAttribute("sd-rdo")),"function"!=typeof v&&(a.listener=function(){Array.from(document.getElementsByName(a.element.name)).some(function(e){if(e.checked)return e.value,!0}),v=a.element.innerHTML})),!a.listener)return!1}else a.listener=function(i){var r,s=!1,l={element:e,event:i};t&&(s[t.itemName]=a[t.itemName],l[t.itemName]=s[t.itemName]),r=-1!==a.reference.indexOf(",")?a.reference.split(","):[a.reference],r.forEach(function(e){n(e,s).apply(l,a.refArgs.map(function(e){return n(e)||e}))})};-1!==a.eventName.indexOf(",")?a.eventName.split(",").forEach(function(e){a.element.addEventListener(e,a.listener)}):a.element.addEventListener(a.eventName,a.listener)}if(s[i].push(a),"if"===i){if(t){var h={};h[t.itemName]=a[t.itemName],a.value=n(a.reference,h)}else a.value=n(a.reference);if(!a.value)return e.style.display="none",c=!0,!0;e.style.display=null}else"for"===i&&(u=!0)})}),c||(u||(m+=e.children.length,Array.from(e.children).forEach(function(e){i(e)})),m-=1,m||f||r())},r=function(){var e;f||(f=!0),["if","for","html","attr","rdo","class"].forEach(function(t){if(s[t].forEach(function(e,r){if(e.element.parentElement){var l,m={element:e.element};switch(t){case"attr":m.attributeName=e.attributeName;break;case"class":m.className=e.className;break;case"for":m.itemName=e.itemName}if(e.itemNames){var f={};e.itemNames.forEach(function(t){f[t]=e[t],m[t]=f[t]}),l=n(e.reference,f)}else l=n(e.reference);if("function"==typeof l&&(l=l.apply(m,e.refArgs.map(function(e){return n(e)||e}))),-1!==["if","class"].indexOf(t)&&"boolean"!=typeof l&&(l=!!l),!e.value||e.value!==l)switch("for"===t&&(l=e.originalHTML.repeat(Array.isArray(e.value)?e.value.length:Object.keys(e.value).length)),e.value=l,t){case"if":l?(e.element.style.display=null,i(e.element)):(e.element.style.display="none",a(e.element,"if"));break;case"for":case"html":Array.from(e.element.children).forEach(function(e){a(e)}),e.element.innerHTML=l,Array.from(e.element.children).forEach(function(n,r){"for"===t?i(n,e,r):i(n)});break;case"attr":-1!==e.attributeName.indexOf(",")?e.attributeName.split(",").forEach(function(t){void 0===l?e.element.hasAttribute(t)&&e.element.removeAttribute(t):e.element.setAttribute(t,l)}):void 0===l?e.element.hasAttribute(e.attributeName)&&e.element.removeAttribute(e.attributeName):e.element.setAttribute(e.attributeName,l);break;case"rdo":Array.from(document.getElementsByName(e.element.name)).forEach(function(e){e.value===l?e.checked=!0:e.checked=!1});break;case"class":-1!==e.className.indexOf(",")?e.className.split(",").forEach(function(t){l?e.element.classList.contains(t)||e.element.classList.add(t):e.element.classList.contains(t)&&e.element.classList.remove(t)}):l?e.element.classList.contains(e.className)||e.element.classList.add(e.className):e.element.classList.contains(e.className)&&e.element.classList.remove(e.className)}}else s[t][r]=!1}),-1!==s[t].indexOf(!1))for(;-1!==(e=s[t].indexOf(!1));)s[t].splice(e,1)}),setTimeout(r,window.directives.refreshRate)},a=function(e,t){var n;["attr","class","for","html","if","on"].forEach(function(t){if(s[t].length)if(e===document.body)"on"===t&&s.on.forEach(function(e){-1!==e.eventName.indexOf(",")?e.eventName.split(",").forEach(function(t){e.element.removeEventListener(t,e.listener)}):e.element.removeEventListener(e.eventName,e.listener)}),s[t].length=0;else if(s[t].map(function(n){return e.contains(n.element)?("on"===t&&(-1!==n.eventName.indexOf(",")?n.eventName.split(",").forEach(function(e){n.element.removeEventListener(e,n.listener)}):n.element.removeEventListener(n.eventName,n.listener)),!1):n}),-1!==s[t].indexOf(!1))for(;-1!==(n=s[t].indexOf(!1));)s[t].splice(n,1)})},window.directives={baseReference:window,refreshRate:100,register:i,unregister:a},"loading"!=document.readyState?setTimeout(function(){i(document.body)}):document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){i(document.body)})})})();