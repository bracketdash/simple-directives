(function(){var e,t,n,i,a,r,s,l={attr:[],class:[],for:[],html:[],if:[],on:[],rdo:[]},m={attr:"attributeName",class:"className",for:"itemName",on:"eventName"},f=1,o=!1;e=function(t){return t=t.replace(/\[([^\[\]]*)\]/g,function(e,t){return"."+n(t)}),/\[[^\[\]]*\]/.test(t)?e(t):t},t=function(e,t){var n=window.directives.baseReference;return e&&(n=Object.assign(e,n)),n[t]},n=function(n,i){var a,r=-1!==n.indexOf("["),s=-1!==n.indexOf("."),l=!1;return 0===n.indexOf("!")&&(n=n.substring(1),l=!0),/[^a-z0-9.[\]:;,$_]/i.test(n)?"":(r||s?(r&&(n=e(n),s||(s=!0)),s&&n.split(".").forEach(function(e,n){a=n?"object"==typeof a&&a[e]?a[e]:"":t(i,e)})):a=t(i,n),l?!a:a)},i=function(e,t,c){var u=!1,d=!1;f||(f=1),s(e),["if","for","html","attr","rdo","class","on"].some(function(i){var r;if(!e.hasAttribute("sd-"+i))return!1;if("rdo"===i){var s=!1;if(l.rdo.some(function(t){if(t.element===e)return s=!0,!0}),s)return!1}r=-1!==["attr","class","on"].indexOf(i)&&-1!==e.getAttribute("sd-attr").indexOf(";")?e.getAttribute("sd-"+i).split(";"):[e.getAttribute("sd-"+i)],r.forEach(function(r){var s={element:e},f=r.split(":");if(-1!==["if","html","rdo"].indexOf(i)?(s.reference=f.shift(),f.length&&(s.refArgs=f)):(s[m[i]]=f.shift(),s.reference=f.shift(),f.length&&(s.refArgs=f)),"for"===i&&(s.originalHTML=e.innerHTML),t){if(s.itemNames||(s.itemNames=[]),s.itemNames.push(t.itemName),Array.isArray(t.value))"object"==typeof t.value[c]?s[t.itemName]=t.value[c]:s[t.itemName]={value:t.value[c]},s[t.itemName].$key=c;else{var o=Object.keys(t.value)[c];"object"==typeof t.value[o]?s[t.itemName]=t.value[o]:s[t.itemName]={value:t.value[o]},s[t.itemName].$key=o}s[t.itemName].$collection=t.value,s[t.itemName].$index=c}if("on"===i){var v;if(v=-1!==s.reference.indexOf(",")?s.reference.split(","):[s.reference],-1!==v.indexOf("$update")){for(var h,b,p;-1!==(p=v.indexOf("$update"));)v.splice(p,1);s.element.hasAttribute("sd-attr")?"input"===s.element.tagName&&-1!==["checkbox","radio"].indexOf(s.element.getAttribute("type"))?(b=s.element.getAttribute("sd-attr"),h=b.indexOf("checked"),-1!==h&&(b=b.substring(h).split(":")[1],h=b.indexOf(";"),-1!==h&&(b=b.substring(0,h)),b=n(b),"function"!=typeof b&&(s.updater=function(){b=s.element.checked}))):(b=s.element.getAttribute("sd-attr"),h=b.indexOf("value"),-1!==h&&(b=b.substring(h).split(":")[1],h=b.indexOf(";"),-1!==h&&(b=b.substring(0,h)),b=n(b),"function"!=typeof b&&(s.updater=function(){b=s.element.value}))):s.element.hasAttribute("sd-html")&&s.element.isContentEditable?(b=n(s.element.getAttribute("sd-html")),"function"!=typeof b&&(s.updater=function(){b=s.element.innerHTML})):s.element.hasAttribute("sd-rdo")&&(b=n(s.element.getAttribute("sd-rdo")),"function"!=typeof b&&(s.updater=function(){var e;Array.from(document.getElementsByName(s.element.name)).some(function(t){if(t.checked)return e=t.value,!0}),b=e}))}v.length&&(s.listener=function(i){var a=!1,r={element:e,event:i};t&&(a[t.itemName]=s[t.itemName],r[t.itemName]=a[t.itemName]),v.forEach(function(e){n(e,a).apply(r,s.refArgs.map(function(e){return n(e)||e}))})}),a("add",s)}if(l[i].push(s),"if"===i){if(t){var N={};N[t.itemName]=s[t.itemName],s.value=n(s.reference,N)}else s.value=n(s.reference);if(!s.value)return e.style.display="none",u=!0,!0;e.style.display=null}else"for"===i&&(d=!0)})}),u||(d||(f+=e.children.length,Array.from(e.children).forEach(function(e){i(e)})),f-=1,f||o||r())},r=function(){var e;o||(o=!0),["if","for","html","attr","rdo","class"].forEach(function(t){if(l[t].forEach(function(e,a){if(e.element.parentElement){var r,m={element:e.element};switch(t){case"attr":m.attributeName=e.attributeName;break;case"class":m.className=e.className;break;case"for":m.itemName=e.itemName}if(e.itemNames){var f={};e.itemNames.forEach(function(t){f[t]=e[t],m[t]=f[t]}),r=n(e.reference,f)}else r=n(e.reference);if("function"==typeof r&&(r=r.apply(m,e.refArgs.map(function(e){return n(e)||e}))),-1!==["if","class"].indexOf(t)&&"boolean"!=typeof r&&(r=!!r),!e.value||e.value!==r)switch("for"===t&&(r=e.originalHTML.repeat(Array.isArray(e.value)?e.value.length:Object.keys(e.value).length)),e.value=r,t){case"if":r?(e.element.style.display=null,i(e.element)):(e.element.style.display="none",s(e.element,"if"));break;case"for":case"html":Array.from(e.element.children).forEach(function(e){s(e)}),e.element.innerHTML=r,Array.from(e.element.children).forEach(function(n,a){"for"===t?i(n,e,a):i(n)});break;case"attr":-1!==e.attributeName.indexOf(",")?e.attributeName.split(",").forEach(function(t){void 0===r?e.element.hasAttribute(t)&&e.element.removeAttribute(t):e.element.setAttribute(t,r)}):void 0===r?e.element.hasAttribute(e.attributeName)&&e.element.removeAttribute(e.attributeName):e.element.setAttribute(e.attributeName,r);break;case"rdo":Array.from(document.getElementsByName(e.element.name)).forEach(function(e){e.value===r?e.checked=!0:e.checked=!1});break;case"class":-1!==e.className.indexOf(",")?e.className.split(",").forEach(function(t){r?e.element.classList.contains(t)||e.element.classList.add(t):e.element.classList.contains(t)&&e.element.classList.remove(t)}):r?e.element.classList.contains(e.className)||e.element.classList.add(e.className):e.element.classList.contains(e.className)&&e.element.classList.remove(e.className)}}else l[t][a]=!1}),-1!==l[t].indexOf(!1))for(;-1!==(e=l[t].indexOf(!1));)l[t].splice(e,1)}),setTimeout(r,window.directives.refreshRate)},a=function(e,t){-1!==t.eventName.indexOf(",")?t.eventName.split(",").forEach(function(n){t.listener&&t.element[e+"EventListener"](n,t.listener),t.updater&&t.element[e+"EventListener"](n,t.updater)}):(t.listener&&t.element[e+"EventListener"](t.eventName,t.listener),t.updater&&t.element[e+"EventListener"](t.eventName,t.updater))},s=function(e,t){var n;["attr","class","for","html","if","on"].forEach(function(t){if(l[t].length)if(e===document.body)"on"===t&&l.on.forEach(function(e){a("remove",e)}),l[t].length=0;else if(l[t].map(function(n){return e.contains(n.element)?("on"===t&&a("remove",n),!1):n}),-1!==l[t].indexOf(!1))for(;-1!==(n=l[t].indexOf(!1));)l[t].splice(n,1)})},window.directives={baseReference:window,refreshRate:100,register:i,unregister:s},"loading"!=document.readyState?setTimeout(function(){i(document.body)}):document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){i(document.body)})})})();