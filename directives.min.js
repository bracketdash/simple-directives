const simpleDirectives={events:{addListeners:function(e){let t=[];e.references.forEach(function(r){t.push(simpleDirectives.events.getAction(e,r))}),e.listener={handleEvent:function(e){t.forEach(function(e){e()})}},e.preReferences.forEach(function(t){e.element.addEventListener(t,e.listener)})},getAction:function(e,t){let r;if("$update"===t)return simpleDirectives.events.getUpdater(e);if(-1!==t.indexOf("=")){const i=t.split("="),n=simpleDirectives.references.convert(i[0],e),s=simpleDirectives.references.convert(i[1],e);r=s.bang?function(){"function"==typeof s.parent[s.target]?n.parent[n.target]=!s.parent[s.target]():n.parent[n.target]=!s.parent[s.target]}:function(){"function"==typeof s.parent[s.target]?n.parent[n.target]=s.parent[s.target]():n.parent[n.target]=s.parent[s.target]}}else{const i=t.split(":"),n=simpleDirectives.references.convert(i[0],e);t=i.shift(),r=function(){let t=i.map(function(t){let r=simpleDirectives.references.convert(t,e);return r.parent[r.target]});n.parent[n.target].apply(e,t)}}return r},getUpdater:function(e){let t,r,{element:i}=e;if(i.hasAttribute("sd-attr")){let n,s="value";t=i.getAttribute("sd-attr"),"input"===i.tagName&&-1!==["checkbox","radio"].indexOf(i.getAttribute("type"))&&(s="checked"),n=t.indexOf(s),-1!==n&&(t=t.substring(n).split(":")[1],n=t.indexOf(";"),-1!==n&&(t=t.substring(0,n)),t=simpleDirectives.references.convert(t,e),r=function(){t.parent[t.target]=i[s]})}else i.hasAttribute("sd-html")&&i.isContentEditable?(t=simpleDirectives.references.convert(i.getAttribute("sd-html"),e),r=function(){t.parent[t.target]=i.innerHTML}):i.hasAttribute("sd-rdo")&&(t=simpleDirectives.references.convert(i.getAttribute("sd-rdo"),e),r=function(){let e;Array.from(document.getElementsByName(i.getAttribute("name"))).some(function(t){if(t.checked)return e=t.value,!0}),t.parent[t.target]=e});return r}},references:{comparison:function(e,t,r){const i=t.split(e);let n,s=simpleDirectives.references.convert(i[0],r),c=simpleDirectives.references.convert(i[1],r);switch(s="function"==typeof s.parent[s.target]?s.parent[s.target].apply(r):s.bang?!s.parent[s.target]:s.parent[s.target],c="function"==typeof c.parent[c.target]?c.parent[c.target].apply(r):c.bang?!c.parent[c.target]:c.parent[c.target],e){case"==":n=s==c;break;case"===":n=s===c;break;case"!=":case"!==":n=s!=c;break;case"<":n=s<c;break;case">":n=s>c;break;case"<=":n=s<=c;break;case">=":n=s>=c}return{parent:{value:n},target:"value"}},convert:function(e,t){const r={parent:{value:e},target:"value"},i=-1!==e.indexOf("[");let n,s,c,a=!1,o=e.split(":");if(e=o.shift(),n=-1!==e.indexOf("."),/[=<!>]/.test(e)){if(0!==e.indexOf("!")||/[=<!>]/.test(e.substring(1))){let i=e.match(/([=<!>]{2,3})/)[0];return-1!==["==","===","!=","!==","<",">","<=",">="].indexOf(i)?simpleDirectives.references.comparison(i,e,t):r}e=e.substring(1),a=!0}if(/[^a-z0-9.[\]$_]/i.test(e))return r;if(s=Object.assign({},simpleDirectives.root,t),i||n){if(i){for(;/\[[^\[\]]*\]/.test(e);)e=e.replace(/\[([^\[\]]*)\]/g,function(e,r){let i=simpleDirectives.references.convert(r,t);return"."+i.parent[i.target]});n||(n=!0)}if(n){let t=e.split(".");t.some(function(r,i){if(i===t.length-1)c=r;else{if("object"!=typeof s||!s.hasOwnProperty(r))return s={value:e},c="value",!0;s=s[r]}})}}else c=e;return{bang:a,parent:s,target:c,refArgs:o}}},register:this.registry.register,registry:{add:function(e,t,r,i,n){const s={attr:"attributeName",class:"className",for:"itemName",on:"eventName"};let c,a,o,l={element:e,type:t,references:r},f=!1,p=!0;switch(n&&Object.assign(l,n),i&&(l.preReferences=i,s[t]&&(l[s[t]]=i)),t){case"for":l.originalHTML=e.innerHTML;break;case"if":c=r[0].split(":"),a=p.shift(),o=simpleDirectives.references.convert(a,l),p=o.parent[o.target],"function"==typeof p&&(p=p.apply(l,c)),o.bang&&(p=!p);break;case"rdo":simpleDirectives.registry.cache.some(function(t){"rdo"===t.type&&t.element===e&&(f=!0)})}return"on"===t?simpleDirectives.events.addListeners(l):simpleDirectives.watchers.addAction(l),f||simpleDirectives.registry.cache.push(l),p},cache:[],register:function(e,t,r){let i,n,s,c,a,o,l=!1;t||simpleDirectives.registry.unregister(e),["if","attr","class","for","html","on","rdo"].some(function(t){if(i=`sd-${t}`,!e.hasAttribute(i))return!1;if(n=e.getAttribute(i).replace(/\s+/,"").split(";"),-1!==["attr","class","for","on"].indexOf(t)?n.forEach(function(i){s=i.split(":"),c=s.shift().split(","),a=s.join(":").split(","),simpleDirectives.registry.add(e,t,a,c,r)}):o=simpleDirectives.registry.add(e,t,[n[0]],[],r),"if"===t){if(!o)return e.style.display="none",l=!0,!0}else"for"===t&&(l=!0)}),l||Array.from(e.children).forEach(function(e){simpleDirectives.registry.register(e,!0)})},unregister:function(e){simpleDirectives.registry.cache=simpleDirectives.registry.cache.map(function(t){let{element:r,type:i}=t;return r===e||e.contains(r)?("on"===i?t.preReferences.forEach(function(e){r.removeEventListener(e,t.listener)}):simpleDirectives.watchers.removeAction(t),null):t}),simpleDirectives.tools.removeNulls(simpleDirectives.registry.cache)}},root:window,tools:{createAction:function(e,t){const{type:r,element:i,preReferences:n}=e;let s;switch(r){case"if":s=function(e){e?(i.style.display=null,simpleDirectives.registry.register(i)):(i.style.display="none",simpleDirectives.registry.unregister(i))};break;case"for":case"html":s=function(e){i.children.length&&Array.from(i.children).forEach(function(e){simpleDirectives.registry.unregister(e)}),i.innerHTML=e,i.children.length&&Array.from(i.children).forEach(function(e){simpleDirectives.registry.unregister(e)})};break;case"attr":s=function(e){if(n.length>1)n.forEach(function(t){void 0===e?i.hasAttribute(t)&&i.removeAttribute(t):i.setAttribute(t,e)});else{const t=n[0];void 0===e?i.hasAttribute(t)&&i.removeAttribute(t):i.setAttribute(t,e)}};break;case"rdo":s=function(e){const t=Array.from(document.getElementsByName(i.getAttribute("name")));t.forEach(function(t){t.value===e?t.checked=!0:t.checked=!1})};break;case"class":s=function(e){if(n.length>1)n.forEach(function(t){e?i.classList.contains(t)||i.classList.add(t):i.classList.contains(t)&&i.classList.remove(t)});else{const t=n[0];e?i.classList.contains(t)||i.classList.add(t):i.classList.contains(t)&&i.classList.remove(t)}}}return function(r){i.parentElement?("function"==typeof r&&(t=t.map(function(t){const r=simpleDirectives.references.convert(t,e);return r.parent[r.target]}),r=r.apply(e,t)),s(r)):simpleDirectives.registry.unregister(i)}},removeNulls:function(e){let t;for(;-1!==(t=e.indexOf(null));)e.splice(t,1)}},watchers:{addAction:function(e){const t=e.references[0].split(":").slice(1),r=simpleDirectives.tools.createAction(e,t);e.action=r,simpleDirectives.watchers.cache.push({action:r,directive:e,lastValue:!1}),simpleDirectives.watchers.running||(simpleDirectives.watchers.runner(),simpleDirectives.watchers.running=!0)},cache:[],removeAction:function(e){simpleDirectives.watchers.cache=simpleDirectives.watchers.cache.map(function(t){return t.action===e.action?null:t}),simpleDirectives.tools.removeNulls(simpleDirectives.watchers.cache)},runner:function(){simpleDirectives.watchers.cache.forEach(function(e){const{action:t,directive:r,lastValue:i}=e,n=r.references[0].split(":"),s=n.shift(),c=simpleDirectives.references.convert(s,r);let a=c.parent[c.target];"function"==typeof a&&(a=a.apply(r,n)),c.bang&&(a=!a),a!==i&&(e.lastValue=a,t(a))}),setTimeout(simpleDirectives.watchers.runner,200)},running:!1}};