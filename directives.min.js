const simpleDirectives={};(function(e){function t(e){return{oneOf:function(t){return-1!==t.indexOf(e)}}}function s(e){let t;for(;-1!==(t=e.indexOf(null));)e.splice(t,1)}class i{constructor(e,t){this.elements=[],this.references=[],this.root=t||window,this.register(e||document.body),this.runner()}register(e,s){let i,r=!1;["attr","class","for","html","if","on","rdo"].some(t=>{e.hasAttribute(`sd-${t}`)&&(r=!0)}),r&&!t(e).oneOf(this.elements)&&(i=new n(this,e,s),this.elements.push(i)),i&&i.hasFalseIf||Array.from(e.children).forEach(e=>this.register(e))}runner(){this.references.forEach(e=>e.run()),setTimeout(this.runner,200)}unregister(e){this.elements=this.elements.map(t=>e.contains(t.raw)?t.unregister():t),s(this.elements)}}class n{constructor(e,t,s){this.directives=[],this.instance=e,this.raw=t,this.scope=s||{},["if","for","attr","class","html","rdo","on"].some(e=>{const s=t.getAttribute(`sd-${e}`);s&&this.directives.push(new r(this,e,s.replace(/\s+/g,"")))})}unregister(){const e=this.directives.map(e=>e.type);return t("on").oneOf(e)&&this.directives.some(e=>{if("on"===e.type)return e.listeners.forEach(e=>e.destroy()),!0}),this.instance.references=this.instance.references.map(e=>{const t=E.bubbleUp(e);return t instanceof c&&this.raw.contains(t.directive.element.raw)?null:e}),s(this.instance.references),null}}class r{constructor(e,t,s){const i=s.split(";");this.raw=s,this.type=t,this.element=e,"on"===t?this.listeners=i.map(e=>new d(this,e)):this.expressions=this.getExpressions(i)}getExpressions(e){return e.map(e=>{switch(this.type){case"if":return new a(this,e);case"attr":return new o(this,e);case"class":return new h(this,e);case"for":return new l(this,e);case"html":return new u(this,e);case"rdo":return new f(this,e)}})}}class c{constructor(e,t,s){this.raw=t,this.directive=e,s||this.assignReference(t)}assignReference(e){const t=E.getReference(this,e);return this.directive.element.instance.references.push(t),t}run(e){}}class a extends c{run(e){const t=this.directive.element;e?(t.raw.style.display=null,Array.from(t.raw.children).forEach(e=>t.instance.register(e))):(t.raw.style.display="none",Array.from(t.raw.children).forEach(e=>t.instance.unregister(e)))}}class o extends c{constructor(e,t){const s=t.split(":");super(e,t,!0),this.attribute=s.shift(),this.assignReference(s.join(":"))}run(e){const s=this.directive.element.raw;"value"===this.attribute&&"SELECT"===s.tagName?Array.from(s.getElementsByTagName("option")).forEach(function(s){Array.isArray(e)&&t(s.value).oneOf(e)||e==s.value?s.selected=!0:s.selected=!1}):void 0===e?s.hasAttribute(this.attribute)&&s.removeAttribute(this.attribute):s.setAttribute(this.attribute,e)}}class h extends c{constructor(e,t){const s=t.split(":");super(e,t,!0),this.classes=s.shift().split(","),this.assignReference(s.join(":"))}run(e){const t=this.directive.element.raw;this.classes.forEach(function(s){e?t.classList.contains(s)||t.classList.add(s):t.classList.contains(s)&&t.classList.remove(s)})}}class l extends c{constructor(e,t){const s=t.split(":");super(e,t,!0),this.alias=s.shift(),this.originalHTML=this.directive.element.raw.innerHTML,this.assignReference(s.join(":"))}run(e){const t=e,s=this.directive.element,i=s.raw,n=i.children.length,r=t.length-n;if(n&&Array.from(i.children).forEach(e=>s.instance.unregister(e)),r<0){let e=Math.abs(r);for(;e>0;)i.removeChild(i.lastChild),e-=1}else r>0&&(i.innerHTML+=this.originalHTML.repeat(r));Array.from(i.children).some(function(e,i){const n=this.element.scope;n[this.alias]=Object.assign({$collection:t,$index:i},t[i]),s.instance.register(e,n)}),"SELECT"===i.tagName&&s.directives.some(e=>{if("attr"===e.type)return e.expressions.some(e=>{if("value"===e.attribute)return setTimeout(function(){e.run(e.reference.get())}),!0}),!0})}}class u extends c{run(e){const t=this.directive.element.instance,s=this.directive.element;Array.from(s.raw.children).forEach(e=>t.unregister(e)),s.raw.innerHTML=e,Array.from(s.raw.children).forEach(e=>t.register(e))}}class f extends c{run(e){const t=this.directive.element.raw.getAttribute("name"),s=Array.from(document.getElementsByName(t));s.forEach(function(t){t.value===e?t.checked=!0:t.checked=!1})}}class d{constructor(e,t){let s=t.split(":");this.directive=e,this.events=s[0].split(","),this.raw=t,s=s.join(":").split(","),this.actions=s.map(e=>"$update"===e?this.getUpdater():-1!==e.indexOf("=")?new b(this,e):new p(this,e)),this.elo=(e=>this.actions.forEach(t=>t.run(e))),this.events.forEach(e=>this.directive.element.raw.addEventListener(e,this.elo))}destroy(){this.events.forEach(e=>{this.directive.element.raw.removeEventListener(e,this.elo)})}getUpdater(){const e=this.directive.element,s=e.directives.map(e=>e.type);return t("attr").oneOf(s)?"INPUT"===e.raw.tagName&&t(e.raw.getAttribute("type")).oneOf(["checkbox","radio"])?new y(this):new v(this):t("html").oneOf(s)&&e.raw.isContentEditable?new w(this):t("rdo").oneOf(s)?new x(this):void 0}}class m{constructor(e,t){this.listener=e,t&&(this.raw=t)}run(e){}}class p extends m{constructor(e,t){super(e,t),this.callee=E.getReference(this,t)}run(e){this.callee.get({event:e})}}class b extends m{constructor(e,t){const s=t.split("=");super(e,t),this.left=E.getReference(this,s.shift()),this.right=E.getReference(this,s[0])}run(){const e=this.right.get();this.left.obj[this.left.key]=e}}class g extends m{}class v extends g{run(){const e=this.listener.directive.element.raw;this.updatee.obj[this.updatee.key]=e.value}}class y extends g{run(){const e=this.listener.directive.element.raw;this.updatee.obj[this.updatee.key]=e.checked}}class w extends g{run(){const e=this.listener.directive.element.raw;this.updatee.obj[this.updatee.key]=e.innerHTML}}class x extends g{run(){const e=this.listener.directive.element.raw.getAttribute("name"),t=Array.from(document.getElementsByName(e));let s;t.some(function(e){if(e.checked)return s=e.value,!0}),this.updatee.obj[this.updatee.key]=s}}class E{constructor(e,t){this.parent=e,this.raw=t}get(e){}run(){let e=this.get();"object"==typeof e&&(e=JSON.stringify(e)),e!==this.value&&(this.value=e,E.bubbleUp(this).run(e))}static bubbleUp(e){let t=e;for(;t instanceof E;)t=t.parent;return t}static getReference(e,t){let s;return s=/[=<!>]/.test(t.substring(1))?new j(e,t):new A(e,t),s}}class j extends E{constructor(e,t){const s=t.match(/([=<!>]{1,3})/)[0],i=t.indexOf(s);super(e,t),this.comparator=s,this.left=E.getReference(this,t.substring(0,i)),this.right=E.getReference(this,t.substring(i+s.length)),e instanceof c&&this.run()}get(e){const t=this.left.get(e),s=this.right.get(e);switch(this.comparator){case"==":return t==s;case"===":return t===s;case"!=":case"!==":return t!=s;case"<":return t<s;case">":return t>s;case"<=":return t<=s;case">=":return t>=s}}}class A extends E{constructor(e,t){const s=t.split(":");super(e,t),this.base=s.shift(),this.obj={value:t},this.key="value",this.base.startsWith("!")&&(this.bang=!0,this.base=this.base.substring(1)),this.args=s.map(e=>E.getReference(this,e));const i=function(){const t=E.bubbleUp(e);return t instanceof m?t.listener.directive.element.scope:t.directive.element.scope}();let n=this.maybeGetObjAndKey(this.base,i);n.nah&&(n=this.maybeGetObjAndKey(this.base)),n.nah||(this.obj=n.obj,this.key=n.key),e instanceof c&&this.run()}get(e){let t=E.bubbleUp(this.parent),s=this.scope(),i=this.obj[this.key];return t=t instanceof c?t.directive:t.listener.directive,s.element=t.element.raw,t instanceof o?s.attributeName=t.attribute:t instanceof h?s.classNames=t.classes:t instanceof l?s.itemName=t.alias:t instanceof d&&(s.eventNames=t.events),e&&Object.assign(s,e),"function"==typeof i&&(i=i.apply(s,this.args.map(t=>t.get(e)))),this.bang?i:!i}scope(){const e=E.bubbleUp(this.parent);return e instanceof m?e.listener.directive.element.scope:e.directive.element.scope}maybeGetObjAndKey(e,t){const s={nah:!0},i=-1!==e.indexOf("[");let n,r=-1!==e.indexOf(".");if(t)n=t;else{let e=E.bubbleUp(this.parent);e=e instanceof c?e.directive.element.instance.root:e.listener.directive.element.instance.root,n=e}if(/[^a-z0-9.[\]$_]/i.test(e))return s;if(!i&&!r)return n.hasOwnProperty(e)?{obj:n,key:e}:s;if(i){for(;/\[[^\[\]]*\]/.test(e);)e=e.replace(/\[([^\[\]]*)\]/g,function(e,s){const i=this.maybeGetObjAndKey(s,t);return"."+i.obj[i.key]});r||(r=!0)}if(r){const t=e.split(".");let i;return t.some(function(e,s){if(s===t.length-1)i=e;else{if("object"!=typeof n||!n.hasOwnProperty(e))return i=!1,!0;n=n[e]}}),"string"==typeof i?{obj:n,key:i}:s}}}e.register=((e,t)=>new i(e,t))})(simpleDirectives);