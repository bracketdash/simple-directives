(function(){var e,t,n,i,a,r,s={attr:[],class:[],for:[],html:[],if:[],on:[]},l={attr:"attributeName",class:"className",for:"itemName",on:"eventName"},m=1,f=!1;e=function(t){return t=t.replace(/\[([^\[\]]*)\]/g,function(e,t){return"."+n(t)}),/\[[^\[\]]*\]/.test(t)?e(t):t},t=function(e,t){var n=window.directives.baseReference;return e&&(n=Object.assign(e,n)),n[t]},n=function(n,i){var a,r=-1!==n.indexOf("["),s=-1!==n.indexOf("."),l=!1;return 0===n.indexOf("!")&&(n=n.substring(1),l=!0),/[^a-z0-9.[\]:;,]/i.test(n)?"":(r||s?(r&&(n=e(n),s||(s=!0)),s&&n.split(".").forEach(function(e,n){a=n?"object"==typeof a&&a[e]?a[e]:"":t(i,e)})):a=t(i,n),l?!a:a)},i=function(e,t,c){var o=!1,u=!1;m||(m=1),r(e),["if","for","html","attr","class","on"].some(function(i){if(!e.hasAttribute("sd-"+i))return!1;var a;a=1!==["attr"].indexOf(i)&&-1!==e.getAttribute("sd-attr").indexOf(";")?e.getAttribute("sd-"+i).split(";"):[e.getAttribute("sd-"+i)],a.forEach(function(a){var r={element:e},m=a.split(":");if(-1!==["if","html"].indexOf(i)?(r.reference=m.shift(),m.length&&(r.refArgs=m)):(r[l[i]]=m.shift(),r.reference=m.shift(),m.length&&(r.refArgs=m)),"for"===i&&(r.originalHTML=e.innerHTML),t)if(r.itemNames||(r.itemNames=[]),r.itemNames.push(t.itemName),Array.isArray(t.value))r[t.itemName]={collection:t.value,key:c,index:c,item:t.value[c],value:t.value[c]};else{var f=Object.keys(t.value)[c];r[t.itemName]={collection:t.value,key:f,index:c,item:t.value[f],value:t.value[f]}}if("on"===i){var d,v;if("$update"===r.reference){if(r.element.hasAttribute("sd-attr")?"input"===r.element.tagName&&-1!==["checkbox","radio"].indexOf(r.element.getAttribute("type"))?(v=r.element.getAttribute("sd-attr"),d=v.indexOf("checked"),-1!==d&&(v=v.substring(d).split(":")[1],d=v.indexOf(";"),-1!==d&&(v=v.substring(0,d)),v=n(v),"function"!=typeof v&&(r.listener=function(){v=r.element.checked}))):(v=r.element.getAttribute("sd-attr"),d=v.indexOf("value"),-1!==d&&(v=v.substring(d).split(":")[1],d=v.indexOf(";"),-1!==d&&(v=v.substring(0,d)),v=n(v),"function"!=typeof v&&(r.listener=function(){v=r.element.value}))):r.element.hasAttribute("sd-html")&&r.element.isContentEditable&&(v=n(r.element.getAttribute("sd-html")),"function"!=typeof v&&(r.listener=function(){v=r.element.innerHTML})),!r.listener)return}else r.listener=function(i){var a={},s={element:e,event:i};t?(a[t.itemName]={key:r[t.itemName].key,index:r[t.itemName].index,item:r[t.itemName].item,value:r[t.itemName].value},s[t.itemName]=a[t.itemName],n(r.reference,a).apply(s,r.refArgs.map(function(e){return n(e)||e}))):n(r.reference).apply(s,r.refArgs.map(function(e){return n(e)||e}))};-1!==r.eventName.indexOf(",")?r.eventName.split(",").forEach(function(e){r.element.addEventListener(e,r.listener)}):r.element.addEventListener(r.eventName,r.listener)}if(s[i].push(r),"if"===i){if(t){var N={};N[t.itemName]={key:r[t.itemName].key,index:r[t.itemName].index,item:r[t.itemName].item,value:r[t.itemName].value},r.value=n(r.reference,N)}else r.value=n(r.reference);if(!r.value)return e.style.display="none",o=!0,!0;e.style.display=null}else"for"===i&&(u=!0)})}),o||(u||(m+=e.children.length,Array.from(e.children).forEach(function(e){i(e)})),m-=1,m||f||a())},a=function(){var e;f||(f=!0),["if","for","attr","class","html"].forEach(function(t){if(s[t].forEach(function(e,a){if(e.element.parentElement){var l,m={element:e.element};switch(t){case"attr":m.attributeName=e.attributeName;break;case"class":m.className=e.className;break;case"for":m.itemName=e.itemName;break;case"on":m.eventName=e.eventName}if(e.itemNames){var f={};e.itemNames.forEach(function(t){f[t]={key:e[t].key,index:e[t].index,item:e[t].item,value:e[t].value},m[t]=f[t]}),l=n(e.reference,f)}else l=n(e.reference);if("function"==typeof l&&(l=l.apply(m,e.refArgs.map(function(e){return n(e)||e}))),-1!==["if","class"].indexOf(t)&&"boolean"!=typeof l&&(l=!!l),!e.value||e.value!==l)switch("for"===t&&(l=e.originalHTML.repeat(Array.isArray(e.value)?e.value.length:Object.keys(e.value).length)),e.value=l,t){case"if":l?(e.element.style.display=null,i(e.element)):(e.element.style.display="none",r(e.element,"if"));break;case"for":case"html":Array.from(e.element.children).forEach(function(e){r(e)}),e.element.innerHTML=l,Array.from(e.element.children).forEach(function(n,a){"for"===t?i(n,e,a):i(n)});break;case"attr":-1!==e.attributeName.indexOf(",")?e.attributeName.split(",").forEach(function(t){void 0===l?e.element.hasAttribute(t)&&e.element.removeAttribute(t):e.element.setAttribute(t,l)}):void 0===l?e.element.hasAttribute(e.attributeName)&&e.element.removeAttribute(e.attributeName):e.element.setAttribute(e.attributeName,l);break;case"class":-1!==e.className.indexOf(",")?e.className.split(",").forEach(function(t){l?e.element.classList.contains(t)||e.element.classList.add(t):e.element.classList.contains(t)&&e.element.classList.remove(t)}):l?e.element.classList.contains(e.className)||e.element.classList.add(e.className):e.element.classList.contains(e.className)&&e.element.classList.remove(e.className)}}else s[t][a]=!1}),-1!==s[t].indexOf(!1))for(;-1!==(e=s[t].indexOf(!1));)s[t].splice(e,1)}),setTimeout(a,window.directives.refreshRate)},r=function(e,t){var n;["attr","class","for","html","if","on"].forEach(function(t){if(s[t].length)if(e===document.body)"on"===t&&s.on.forEach(function(e){-1!==e.eventName.indexOf(",")?e.eventName.split(",").forEach(function(t){e.element.removeEventListener(t,e.listener)}):e.element.removeEventListener(e.eventName,e.listener)}),s[t].length=0;else if(s[t].map(function(n){return e.contains(n.element)?("on"===t&&(-1!==n.eventName.indexOf(",")?n.eventName.split(",").forEach(function(e){n.element.removeEventListener(e,n.listener)}):n.element.removeEventListener(n.eventName,n.listener)),!1):n}),-1!==s[t].indexOf(!1))for(;-1!==(n=s[t].indexOf(!1));)s[t].splice(n,1)})},window.directives={baseReference:window,refreshRate:100,register:i,unregister:r},"loading"!=document.readyState?setTimeout(function(){i(document.body)}):document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){i(document.body)})})})();